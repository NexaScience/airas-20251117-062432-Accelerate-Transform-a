variations:
  # ===========================================================================
  # 1) Baseline — DeepSpeed-ZeRO-2 + standard Dropout (FlashAttention OFF)
  # ===========================================================================
  - run_id: baseline-zeor2
    description: "Baseline with ZeRO-2 optimiser and standard Dropout"
    seed: 42
    dataset:
      name: Lots-of-LoRAs/task1288_glue_mrpc_paraphrasing
      seq_length: 128
      batch_size: 32
      num_classes: 2
    model:
      type: hf
      name: allenai/longformer-base-4096
    training:
      epochs: 3
      learning_rate: 3e-5
      use_pmdrop: false
      fp16: true
      use_flash_attn: false
      use_tempo: false

  # ===========================================================================
  # 2) Proposed — PM-Drop + ZeRO-2 (no FlashAttention)
  # ===========================================================================
  - run_id: pm-drop-zeor2
    description: "Packed-Mask Dropout with ZeRO-2"
    seed: 42
    dataset:
      name: Lots-of-LoRAs/task1288_glue_mrpc_paraphrasing
      seq_length: 128
      batch_size: 32
      num_classes: 2
    model:
      type: hf
      name: allenai/longformer-base-4096
    training:
      epochs: 3
      learning_rate: 3e-5
      use_pmdrop: true
      fp16: true
      use_flash_attn: false
      use_tempo: false

  # ===========================================================================
  # 3) PM-Drop + ZeRO-2 + FlashAttention-2 (stub)
  # ===========================================================================
  - run_id: pm-drop-zeor2-flash
    description: "PM-Drop combined with FlashAttention-2 (stub integration)"
    seed: 42
    dataset:
      name: Lots-of-LoRAs/task1288_glue_mrpc_paraphrasing
      seq_length: 128
      batch_size: 32
      num_classes: 2
    model:
      type: hf
      name: allenai/longformer-base-4096
    training:
      epochs: 3
      learning_rate: 3e-5
      use_pmdrop: true
      fp16: true
      use_flash_attn: true
      use_tempo: false

  # ===========================================================================
  # 4) PM-Drop + ZeRO-2 + FlashAttention-2 + Tempo (all techniques enabled)
  # ===========================================================================
  - run_id: pm-drop-zeor2-flash-tempo
    description: "PM-Drop + FlashAttention-2 + Tempo activation off-loading (all techniques)"
    seed: 42
    dataset:
      name: Lots-of-LoRAs/task1288_glue_mrpc_paraphrasing
      seq_length: 128
      batch_size: 32
      num_classes: 2
    model:
      type: hf
      name: allenai/longformer-base-4096
    training:
      epochs: 3
      learning_rate: 3e-5
      use_pmdrop: true
      fp16: true
      use_flash_attn: true
      use_tempo: true

  # ---------------------------------------------------------------------------
  # Additional ablations such as different learning-rates or dropout-p values
  # can be appended here following the same schema.
  # ---------------------------------------------------------------------------
  
  # Example hyper-parameter study for learning-rate & dropout-p under PM-Drop
  - run_id: pm-drop-zeor2-lr1e4
    description: "PM-Drop with learning-rate 1e-4 (hyper-param study)"
    seed: 42
    dataset:
      name: Lots-of-LoRAs/task1288_glue_mrpc_paraphrasing
      seq_length: 128
      batch_size: 32
      num_classes: 2
    model:
      type: hf
      name: allenai/longformer-base-4096
    training:
      epochs: 3
      learning_rate: 1e-4
      use_pmdrop: true
      fp16: true
      use_flash_attn: false
      use_tempo: false

  - run_id: pm-drop-zeor2-lr2e4
    description: "PM-Drop with learning-rate 2e-4 (hyper-param study)"
    seed: 42
    dataset:
      name: Lots-of-LoRAs/task1288_glue_mrpc_paraphrasing
      seq_length: 128
      batch_size: 32
      num_classes: 2
    model:
      type: hf
      name: allenai/longformer-base-4096
    training:
      epochs: 3
      learning_rate: 2e-4
      use_pmdrop: true
      fp16: true
      use_flash_attn: false
      use_tempo: false

  - run_id: pm-drop-zeor2-dropout0
    description: "PM-Drop with dropout-p = 0.0 (hyper-param study)"
    seed: 42
    dataset:
      name: Lots-of-LoRAs/task1288_glue_mrpc_paraphrasing
      seq_length: 128
      batch_size: 32
      num_classes: 2
    model:
      type: hf
      name: allenai/longformer-base-4096
    training:
      epochs: 3
      learning_rate: 3e-5
      use_pmdrop: true
      fp16: true
      use_flash_attn: false
      use_tempo: false
      dropout_p_override: 0.0

  - run_id: pm-drop-zeor2-dropout01
    description: "PM-Drop with dropout-p = 0.1 (hyper-param study)"
    seed: 42
    dataset:
      name: Lots-of-LoRAs/task1288_glue_mrpc_paraphrasing
      seq_length: 128
      batch_size: 32
      num_classes: 2
    model:
      type: hf
      name: allenai/longformer-base-4096
    training:
      epochs: 3
      learning_rate: 3e-5
      use_pmdrop: true
      fp16: true
      use_flash_attn: false
      use_tempo: false
      dropout_p_override: 0.1

  # End of configuration list
  # ===========================================================================
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  # ===========================================================================
  # End of full_experiment.yaml
  # ===========================================================================
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  

  